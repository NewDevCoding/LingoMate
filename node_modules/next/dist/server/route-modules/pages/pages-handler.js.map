{"version":3,"sources":["../../../../src/server/route-modules/pages/pages-handler.ts"],"sourcesContent":["import type { IncomingMessage, ServerResponse } from 'node:http'\nimport type { ParsedUrlQuery } from 'node:querystring'\nimport { RouteKind } from '../../route-kind'\nimport { BaseServerSpan } from '../../lib/trace/constants'\nimport { getTracer, SpanKind, type Span } from '../../lib/trace/tracer'\nimport { formatUrl } from '../../../shared/lib/router/utils/format-url'\nimport { addRequestMeta, getRequestMeta } from '../../request-meta'\nimport { interopDefault } from '../../app-render/interop-default'\nimport { getRevalidateReason } from '../../instrumentation/utils'\nimport { normalizeDataPath } from '../../../shared/lib/page-path/normalize-data-path'\nimport {\n  CachedRouteKind,\n  type CachedPageValue,\n  type CachedRedirectValue,\n  type ResponseCacheEntry,\n  type ResponseGenerator,\n} from '../../response-cache'\n\nimport {\n  getCacheControlHeader,\n  type CacheControl,\n} from '../../lib/cache-control'\nimport { normalizeRepeatedSlashes } from '../../../shared/lib/utils'\nimport { getRedirectStatus } from '../../../lib/redirect-status'\nimport {\n  CACHE_ONE_YEAR,\n  HTML_CONTENT_TYPE_HEADER,\n  JSON_CONTENT_TYPE_HEADER,\n} from '../../../lib/constants'\nimport path from 'path'\nimport { sendRenderResult } from '../../send-payload'\nimport RenderResult from '../../render-result'\nimport { toResponseCacheEntry } from '../../response-cache/utils'\nimport { NoFallbackError } from '../../../shared/lib/no-fallback-error.external'\nimport { RedirectStatusCode } from '../../../client/components/redirect-status-code'\nimport { isBot } from '../../../shared/lib/router/utils/is-bot'\nimport { addPathPrefix } from '../../../shared/lib/router/utils/add-path-prefix'\nimport { removeTrailingSlash } from '../../../shared/lib/router/utils/remove-trailing-slash'\nimport type { PagesRouteModule } from './module.compiled'\nimport type {\n  GetServerSideProps,\n  GetStaticPaths,\n  GetStaticProps,\n} from '../../../types'\n\nexport const getHandler = ({\n  srcPage: originalSrcPage,\n  config,\n  userland,\n  routeModule,\n  isFallbackError,\n  getStaticPaths,\n  getStaticProps,\n  getServerSideProps,\n}: {\n  srcPage: string\n  config: Record<string, any> | undefined\n  userland: any\n  isFallbackError?: boolean\n  routeModule: PagesRouteModule\n  getStaticProps?: GetStaticProps\n  getStaticPaths?: GetStaticPaths\n  getServerSideProps?: GetServerSideProps\n}) => {\n  return async function handler(\n    req: IncomingMessage,\n    res: ServerResponse,\n    ctx: {\n      waitUntil: (prom: Promise<void>) => void\n    }\n  ): Promise<void> {\n    let srcPage = originalSrcPage\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n      srcPage = srcPage.replace(/\\/index$/, '') || '/'\n    } else if (srcPage === '/index') {\n      // we always normalize /index specifically\n      srcPage = '/'\n    }\n    const multiZoneDraftMode = process.env\n      .__NEXT_MULTI_ZONE_DRAFT_MODE as any as boolean\n\n    const prepareResult = await routeModule.prepare(req, res, {\n      srcPage,\n      multiZoneDraftMode,\n    })\n\n    if (!prepareResult) {\n      res.statusCode = 400\n      res.end('Bad Request')\n      ctx.waitUntil?.(Promise.resolve())\n      return\n    }\n\n    const {\n      buildId,\n      query,\n      params,\n      parsedUrl,\n      originalQuery,\n      originalPathname,\n      buildManifest,\n      fallbackBuildManifest,\n      nextFontManifest,\n      serverFilesManifest,\n      reactLoadableManifest,\n      prerenderManifest,\n      isDraftMode,\n      isOnDemandRevalidate,\n      revalidateOnlyGenerated,\n      locale,\n      locales,\n      defaultLocale,\n      routerServerContext,\n      nextConfig,\n      resolvedPathname,\n      encodedResolvedPathname,\n    } = prepareResult\n\n    const isExperimentalCompile =\n      serverFilesManifest?.config?.experimental?.isExperimentalCompile\n\n    const hasServerProps = Boolean(getServerSideProps)\n    const hasStaticProps = Boolean(getStaticProps)\n    const hasStaticPaths = Boolean(getStaticPaths)\n    const hasGetInitialProps = Boolean(\n      (userland.default || userland).getInitialProps\n    )\n    let cacheKey: null | string = null\n    let isIsrFallback = false\n    let isNextDataRequest =\n      prepareResult.isNextDataRequest && (hasStaticProps || hasServerProps)\n\n    const is404Page = srcPage === '/404'\n    const is500Page = srcPage === '/500'\n    const isErrorPage = srcPage === '/_error'\n\n    if (!routeModule.isDev && !isDraftMode && hasStaticProps) {\n      cacheKey = `${locale ? `/${locale}` : ''}${\n        (srcPage === '/' || resolvedPathname === '/') && locale\n          ? ''\n          : resolvedPathname\n      }`\n\n      if (is404Page || is500Page || isErrorPage) {\n        cacheKey = `${locale ? `/${locale}` : ''}${srcPage}`\n      }\n\n      // ensure /index and / is normalized to one key\n      cacheKey = cacheKey === '/index' ? '/' : cacheKey\n    }\n\n    if (hasStaticPaths && !isDraftMode) {\n      const decodedPathname = removeTrailingSlash(\n        locale\n          ? addPathPrefix(resolvedPathname, `/${locale}`)\n          : resolvedPathname\n      )\n      const isPrerendered =\n        Boolean(prerenderManifest.routes[decodedPathname]) ||\n        prerenderManifest.notFoundRoutes.includes(decodedPathname)\n\n      const prerenderInfo = prerenderManifest.dynamicRoutes[srcPage]\n\n      if (prerenderInfo) {\n        if (prerenderInfo.fallback === false && !isPrerendered) {\n          throw new NoFallbackError()\n        }\n\n        if (\n          typeof prerenderInfo.fallback === 'string' &&\n          !isPrerendered &&\n          !isNextDataRequest\n        ) {\n          isIsrFallback = true\n        }\n      }\n    }\n\n    // When serving a bot request, we want to serve a blocking render and not\n    // the prerendered page. This ensures that the correct content is served\n    // to the bot in the head.\n    if (\n      (isIsrFallback && isBot(req.headers['user-agent'] || '')) ||\n      getRequestMeta(req, 'minimalMode')\n    ) {\n      isIsrFallback = false\n    }\n\n    const tracer = getTracer()\n    const activeSpan = tracer.getActiveScopeSpan()\n\n    try {\n      const method = req.method || 'GET'\n\n      const resolvedUrl = formatUrl({\n        pathname: nextConfig.trailingSlash\n          ? `${encodedResolvedPathname}${!encodedResolvedPathname.endsWith('/') && parsedUrl.pathname?.endsWith('/') ? '/' : ''}`\n          : removeTrailingSlash(encodedResolvedPathname || '/'),\n        // make sure to only add query values from original URL\n        query: hasStaticProps ? {} : originalQuery,\n      })\n\n      const handleResponse = async (span?: Span) => {\n        const responseGenerator: ResponseGenerator = async ({\n          previousCacheEntry,\n        }) => {\n          const doRender = async () => {\n            try {\n              return await routeModule\n                .render(req, res, {\n                  query:\n                    hasStaticProps && !isExperimentalCompile\n                      ? ({\n                          ...params,\n                        } as ParsedUrlQuery)\n                      : {\n                          ...query,\n                          ...params,\n                        },\n                  params,\n                  page: srcPage,\n                  renderContext: {\n                    isDraftMode,\n                    isFallback: isIsrFallback,\n                    developmentNotFoundSourcePage: getRequestMeta(\n                      req,\n                      'developmentNotFoundSourcePage'\n                    ),\n                  },\n                  sharedContext: {\n                    buildId,\n                    customServer:\n                      Boolean(routerServerContext?.isCustomServer) || undefined,\n                    deploymentId: process.env.NEXT_DEPLOYMENT_ID,\n                  },\n                  renderOpts: {\n                    params,\n                    routeModule,\n                    page: srcPage,\n                    pageConfig: config || {},\n                    Component: interopDefault(userland),\n                    ComponentMod: userland,\n                    getStaticProps,\n                    getStaticPaths,\n                    getServerSideProps,\n                    supportsDynamicResponse: !hasStaticProps,\n                    buildManifest: isFallbackError\n                      ? fallbackBuildManifest\n                      : buildManifest,\n                    nextFontManifest,\n                    reactLoadableManifest,\n\n                    assetPrefix: nextConfig.assetPrefix,\n                    previewProps: prerenderManifest.preview,\n                    images: nextConfig.images as any,\n                    nextConfigOutput: nextConfig.output,\n                    optimizeCss: Boolean(nextConfig.experimental.optimizeCss),\n                    nextScriptWorkers: Boolean(\n                      nextConfig.experimental.nextScriptWorkers\n                    ),\n                    domainLocales: nextConfig.i18n?.domains,\n                    crossOrigin: nextConfig.crossOrigin,\n\n                    multiZoneDraftMode,\n                    basePath: nextConfig.basePath,\n                    disableOptimizedLoading:\n                      nextConfig.experimental.disableOptimizedLoading,\n                    largePageDataBytes:\n                      nextConfig.experimental.largePageDataBytes,\n\n                    isExperimentalCompile,\n\n                    experimental: {\n                      clientTraceMetadata:\n                        nextConfig.experimental.clientTraceMetadata ||\n                        ([] as any),\n                    },\n\n                    locale,\n                    locales,\n                    defaultLocale,\n                    setIsrStatus: routerServerContext?.setIsrStatus,\n\n                    isNextDataRequest:\n                      isNextDataRequest && (hasServerProps || hasStaticProps),\n\n                    resolvedUrl,\n                    // For getServerSideProps and getInitialProps we need to ensure we use the original URL\n                    // and not the resolved URL to prevent a hydration mismatch on\n                    // asPath\n                    resolvedAsPath:\n                      hasServerProps || hasGetInitialProps\n                        ? formatUrl({\n                            // we use the original URL pathname less the _next/data prefix if\n                            // present\n                            pathname: isNextDataRequest\n                              ? normalizeDataPath(originalPathname)\n                              : originalPathname,\n                            query: originalQuery,\n                          })\n                        : resolvedUrl,\n\n                    isOnDemandRevalidate,\n\n                    ErrorDebug: getRequestMeta(req, 'PagesErrorDebug'),\n                    err: getRequestMeta(req, 'invokeError'),\n                    dev: routeModule.isDev,\n\n                    // needed for experimental.optimizeCss feature\n                    distDir: path.join(\n                      /* turbopackIgnore: true */\n                      process.cwd(),\n                      routeModule.relativeProjectDir,\n                      routeModule.distDir\n                    ),\n                  },\n                })\n                .then((renderResult): ResponseCacheEntry => {\n                  const { metadata } = renderResult\n\n                  let cacheControl: CacheControl | undefined =\n                    metadata.cacheControl\n\n                  if ('isNotFound' in metadata && metadata.isNotFound) {\n                    return {\n                      value: null,\n                      cacheControl,\n                    } satisfies ResponseCacheEntry\n                  }\n\n                  // Handle `isRedirect`.\n                  if (metadata.isRedirect) {\n                    return {\n                      value: {\n                        kind: CachedRouteKind.REDIRECT,\n                        props: metadata.pageData ?? metadata.flightData,\n                      } satisfies CachedRedirectValue,\n                      cacheControl,\n                    } satisfies ResponseCacheEntry\n                  }\n\n                  return {\n                    value: {\n                      kind: CachedRouteKind.PAGES,\n                      html: renderResult,\n                      pageData: renderResult.metadata.pageData,\n                      headers: renderResult.metadata.headers,\n                      status: renderResult.metadata.statusCode,\n                    },\n                    cacheControl,\n                  }\n                })\n                .finally(() => {\n                  if (!span) return\n\n                  span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false,\n                  })\n\n                  const rootSpanAttributes = tracer.getRootSpanAttributes()\n                  // We were unable to get attributes, probably OTEL is not enabled\n                  if (!rootSpanAttributes) {\n                    return\n                  }\n\n                  if (\n                    rootSpanAttributes.get('next.span_type') !==\n                    BaseServerSpan.handleRequest\n                  ) {\n                    console.warn(\n                      `Unexpected root span type '${rootSpanAttributes.get(\n                        'next.span_type'\n                      )}'. Please report this Next.js issue https://github.com/vercel/next.js`\n                    )\n                    return\n                  }\n\n                  const route = rootSpanAttributes.get('next.route')\n                  if (route) {\n                    const name = `${method} ${route}`\n\n                    span.setAttributes({\n                      'next.route': route,\n                      'http.route': route,\n                      'next.span_name': name,\n                    })\n                    span.updateName(name)\n                  } else {\n                    span.updateName(`${method} ${srcPage}`)\n                  }\n                })\n            } catch (err: unknown) {\n              // if this is a background revalidate we need to report\n              // the request error here as it won't be bubbled\n              if (previousCacheEntry?.isStale) {\n                await routeModule.onRequestError(\n                  req,\n                  err,\n                  {\n                    routerKind: 'Pages Router',\n                    routePath: srcPage,\n                    routeType: 'render',\n                    revalidateReason: getRevalidateReason({\n                      isStaticGeneration: hasStaticProps,\n                      isOnDemandRevalidate,\n                    }),\n                  },\n                  routerServerContext\n                )\n              }\n              throw err\n            }\n          }\n\n          // if we've already generated this page we no longer\n          // serve the fallback\n          if (previousCacheEntry) {\n            isIsrFallback = false\n          }\n\n          if (isIsrFallback) {\n            const fallbackResponse = await routeModule\n              .getResponseCache(req)\n              .get(\n                routeModule.isDev\n                  ? null\n                  : locale\n                    ? `/${locale}${srcPage}`\n                    : srcPage,\n                async ({\n                  previousCacheEntry: previousFallbackCacheEntry = null,\n                }) => {\n                  if (!routeModule.isDev) {\n                    return toResponseCacheEntry(previousFallbackCacheEntry)\n                  }\n                  return doRender()\n                },\n                {\n                  routeKind: RouteKind.PAGES,\n                  isFallback: true,\n                  isRoutePPREnabled: false,\n                  isOnDemandRevalidate: false,\n                  incrementalCache: await routeModule.getIncrementalCache(\n                    req,\n                    nextConfig,\n                    prerenderManifest\n                  ),\n                  waitUntil: ctx.waitUntil,\n                }\n              )\n            if (fallbackResponse) {\n              // Remove the cache control from the response to prevent it from being\n              // used in the surrounding cache.\n              delete fallbackResponse.cacheControl\n              fallbackResponse.isMiss = true\n              return fallbackResponse\n            }\n          }\n\n          if (\n            !getRequestMeta(req, 'minimalMode') &&\n            isOnDemandRevalidate &&\n            revalidateOnlyGenerated &&\n            !previousCacheEntry\n          ) {\n            res.statusCode = 404\n            // on-demand revalidate always sets this header\n            res.setHeader('x-nextjs-cache', 'REVALIDATED')\n            res.end('This page could not be found')\n            return null\n          }\n\n          if (\n            isIsrFallback &&\n            previousCacheEntry?.value?.kind === CachedRouteKind.PAGES\n          ) {\n            return {\n              value: {\n                kind: CachedRouteKind.PAGES,\n                html: new RenderResult(\n                  Buffer.from(previousCacheEntry.value.html),\n                  {\n                    contentType: HTML_CONTENT_TYPE_HEADER,\n                    metadata: {\n                      statusCode: previousCacheEntry.value.status,\n                      headers: previousCacheEntry.value.headers,\n                    },\n                  }\n                ),\n                pageData: {},\n                status: previousCacheEntry.value.status,\n                headers: previousCacheEntry.value.headers,\n              } satisfies CachedPageValue,\n              cacheControl: { revalidate: 0, expire: undefined },\n            } satisfies ResponseCacheEntry\n          }\n          return doRender()\n        }\n\n        const result = await routeModule.handleResponse({\n          cacheKey,\n          req,\n          nextConfig,\n          routeKind: RouteKind.PAGES,\n          isOnDemandRevalidate,\n          revalidateOnlyGenerated,\n          waitUntil: ctx.waitUntil,\n          responseGenerator: responseGenerator,\n          prerenderManifest,\n        })\n\n        // if we got a cache hit this wasn't an ISR fallback\n        // but it wasn't generated during build so isn't in the\n        // prerender-manifest\n        if (isIsrFallback && !result?.isMiss) {\n          isIsrFallback = false\n        }\n\n        // response is finished is no cache entry\n        if (!result) {\n          return\n        }\n\n        if (hasStaticProps && !getRequestMeta(req, 'minimalMode')) {\n          res.setHeader(\n            'x-nextjs-cache',\n            isOnDemandRevalidate\n              ? 'REVALIDATED'\n              : result.isMiss\n                ? 'MISS'\n                : result.isStale\n                  ? 'STALE'\n                  : 'HIT'\n          )\n        }\n\n        let cacheControl: CacheControl | undefined\n\n        if (!hasStaticProps || isIsrFallback) {\n          if (!res.getHeader('Cache-Control')) {\n            cacheControl = { revalidate: 0, expire: undefined }\n          }\n        } else if (is404Page) {\n          const notFoundRevalidate = getRequestMeta(req, 'notFoundRevalidate')\n\n          cacheControl = {\n            revalidate:\n              typeof notFoundRevalidate === 'undefined'\n                ? 0\n                : notFoundRevalidate,\n            expire: undefined,\n          }\n        } else if (is500Page) {\n          cacheControl = { revalidate: 0, expire: undefined }\n        } else if (result.cacheControl) {\n          // If the cache entry has a cache control with a revalidate value that's\n          // a number, use it.\n          if (typeof result.cacheControl.revalidate === 'number') {\n            if (result.cacheControl.revalidate < 1) {\n              throw new Error(\n                `Invalid revalidate configuration provided: ${result.cacheControl.revalidate} < 1`\n              )\n            }\n            cacheControl = {\n              revalidate: result.cacheControl.revalidate,\n              expire: result.cacheControl?.expire ?? nextConfig.expireTime,\n            }\n          } else {\n            // revalidate: false\n            cacheControl = {\n              revalidate: CACHE_ONE_YEAR,\n              expire: undefined,\n            }\n          }\n        }\n\n        // If cache control is already set on the response we don't\n        // override it to allow users to customize it via next.config\n        if (cacheControl && !res.getHeader('Cache-Control')) {\n          res.setHeader('Cache-Control', getCacheControlHeader(cacheControl))\n        }\n\n        // notFound: true case\n        if (!result.value) {\n          // add revalidate metadata before rendering 404 page\n          // so that we can use this as source of truth for the\n          // cache-control header instead of what the 404 page returns\n          // for the revalidate value\n          addRequestMeta(\n            req,\n            'notFoundRevalidate',\n            result.cacheControl?.revalidate\n          )\n\n          res.statusCode = 404\n\n          if (isNextDataRequest) {\n            res.end('{\"notFound\":true}')\n            return\n          }\n          // TODO: should route-module itself handle rendering the 404\n          if (routerServerContext?.render404) {\n            await routerServerContext.render404(req, res, parsedUrl, false)\n          } else {\n            res.end('This page could not be found')\n          }\n          return\n        }\n\n        if (result.value.kind === CachedRouteKind.REDIRECT) {\n          if (isNextDataRequest) {\n            res.setHeader('content-type', JSON_CONTENT_TYPE_HEADER)\n            res.end(JSON.stringify(result.value.props))\n            return\n          } else {\n            const handleRedirect = (pageData: any) => {\n              const redirect = {\n                destination: pageData.pageProps.__N_REDIRECT,\n                statusCode: pageData.pageProps.__N_REDIRECT_STATUS,\n                basePath: pageData.pageProps.__N_REDIRECT_BASE_PATH,\n              }\n              const statusCode = getRedirectStatus(redirect)\n              const { basePath } = nextConfig\n\n              if (\n                basePath &&\n                redirect.basePath !== false &&\n                redirect.destination.startsWith('/')\n              ) {\n                redirect.destination = `${basePath}${redirect.destination}`\n              }\n\n              if (redirect.destination.startsWith('/')) {\n                redirect.destination = normalizeRepeatedSlashes(\n                  redirect.destination\n                )\n              }\n\n              res.statusCode = statusCode\n              res.setHeader('Location', redirect.destination)\n              if (statusCode === RedirectStatusCode.PermanentRedirect) {\n                res.setHeader('Refresh', `0;url=${redirect.destination}`)\n              }\n              res.end(redirect.destination)\n            }\n            await handleRedirect(result.value.props)\n            return null\n          }\n        }\n\n        if (result.value.kind !== CachedRouteKind.PAGES) {\n          throw new Error(\n            `Invariant: received non-pages cache entry in pages handler`\n          )\n        }\n\n        // In dev, we should not cache pages for any reason.\n        if (routeModule.isDev) {\n          res.setHeader('Cache-Control', 'no-store, must-revalidate')\n        }\n\n        // Draft mode should never be cached\n        if (isDraftMode) {\n          res.setHeader(\n            'Cache-Control',\n            'private, no-cache, no-store, max-age=0, must-revalidate'\n          )\n        }\n\n        // when invoking _error before pages/500 we don't actually\n        // send the _error response\n        if (\n          getRequestMeta(req, 'customErrorRender') ||\n          (isErrorPage &&\n            getRequestMeta(req, 'minimalMode') &&\n            res.statusCode === 500)\n        ) {\n          return null\n        }\n\n        await sendRenderResult({\n          req,\n          res,\n          // If we are rendering the error page it's not a data request\n          // anymore\n          result:\n            isNextDataRequest && !isErrorPage && !is500Page\n              ? new RenderResult(\n                  Buffer.from(JSON.stringify(result.value.pageData)),\n                  {\n                    contentType: JSON_CONTENT_TYPE_HEADER,\n                    metadata: result.value.html.metadata,\n                  }\n                )\n              : result.value.html,\n          generateEtags: nextConfig.generateEtags,\n          poweredByHeader: nextConfig.poweredByHeader,\n          cacheControl: routeModule.isDev ? undefined : cacheControl,\n        })\n      }\n\n      // TODO: activeSpan code path is for when wrapped by\n      // next-server can be removed when this is no longer used\n      if (activeSpan) {\n        await handleResponse()\n      } else {\n        await tracer.withPropagatedContext(req.headers, () =>\n          tracer.trace(\n            BaseServerSpan.handleRequest,\n            {\n              spanName: `${method} ${srcPage}`,\n              kind: SpanKind.SERVER,\n              attributes: {\n                'http.method': method,\n                'http.target': req.url,\n              },\n            },\n            handleResponse\n          )\n        )\n      }\n    } catch (err) {\n      if (!(err instanceof NoFallbackError)) {\n        await routeModule.onRequestError(\n          req,\n          err,\n          {\n            routerKind: 'Pages Router',\n            routePath: srcPage,\n            routeType: 'render',\n            revalidateReason: getRevalidateReason({\n              isStaticGeneration: hasStaticProps,\n              isOnDemandRevalidate,\n            }),\n          },\n          routerServerContext\n        )\n      }\n\n      // rethrow so that we can handle serving error page\n      throw err\n    }\n  }\n}\n"],"names":["getHandler","srcPage","originalSrcPage","config","userland","routeModule","isFallbackError","getStaticPaths","getStaticProps","getServerSideProps","handler","req","res","ctx","serverFilesManifest","process","env","TURBOPACK","replace","multiZoneDraftMode","__NEXT_MULTI_ZONE_DRAFT_MODE","prepareResult","prepare","statusCode","end","waitUntil","Promise","resolve","buildId","query","params","parsedUrl","originalQuery","originalPathname","buildManifest","fallbackBuildManifest","nextFontManifest","reactLoadableManifest","prerenderManifest","isDraftMode","isOnDemandRevalidate","revalidateOnlyGenerated","locale","locales","defaultLocale","routerServerContext","nextConfig","resolvedPathname","encodedResolvedPathname","isExperimentalCompile","experimental","hasServerProps","Boolean","hasStaticProps","hasStaticPaths","hasGetInitialProps","default","getInitialProps","cacheKey","isIsrFallback","isNextDataRequest","is404Page","is500Page","isErrorPage","isDev","decodedPathname","removeTrailingSlash","addPathPrefix","isPrerendered","routes","notFoundRoutes","includes","prerenderInfo","dynamicRoutes","fallback","NoFallbackError","isBot","headers","getRequestMeta","tracer","getTracer","activeSpan","getActiveScopeSpan","method","resolvedUrl","formatUrl","pathname","trailingSlash","endsWith","handleResponse","span","responseGenerator","previousCacheEntry","doRender","render","page","renderContext","isFallback","developmentNotFoundSourcePage","sharedContext","customServer","isCustomServer","undefined","deploymentId","NEXT_DEPLOYMENT_ID","renderOpts","pageConfig","Component","interopDefault","ComponentMod","supportsDynamicResponse","assetPrefix","previewProps","preview","images","nextConfigOutput","output","optimizeCss","nextScriptWorkers","domainLocales","i18n","domains","crossOrigin","basePath","disableOptimizedLoading","largePageDataBytes","clientTraceMetadata","setIsrStatus","resolvedAsPath","normalizeDataPath","ErrorDebug","err","dev","distDir","path","join","cwd","relativeProjectDir","then","renderResult","metadata","cacheControl","isNotFound","value","isRedirect","kind","CachedRouteKind","REDIRECT","props","pageData","flightData","PAGES","html","status","finally","setAttributes","rootSpanAttributes","getRootSpanAttributes","get","BaseServerSpan","handleRequest","console","warn","route","name","updateName","isStale","onRequestError","routerKind","routePath","routeType","revalidateReason","getRevalidateReason","isStaticGeneration","fallbackResponse","getResponseCache","previousFallbackCacheEntry","toResponseCacheEntry","routeKind","RouteKind","isRoutePPREnabled","incrementalCache","getIncrementalCache","isMiss","setHeader","RenderResult","Buffer","from","contentType","HTML_CONTENT_TYPE_HEADER","revalidate","expire","result","getHeader","notFoundRevalidate","Error","expireTime","CACHE_ONE_YEAR","getCacheControlHeader","addRequestMeta","render404","JSON_CONTENT_TYPE_HEADER","JSON","stringify","handleRedirect","redirect","destination","pageProps","__N_REDIRECT","__N_REDIRECT_STATUS","__N_REDIRECT_BASE_PATH","getRedirectStatus","startsWith","normalizeRepeatedSlashes","RedirectStatusCode","PermanentRedirect","sendRenderResult","generateEtags","poweredByHeader","withPropagatedContext","trace","spanName","SpanKind","SERVER","attributes","url"],"mappings":"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","ignoreList":[0]}
{"version":3,"sources":["../../../../src/server/route-modules/pages/pages-handler.ts"],"sourcesContent":["import type { IncomingMessage, ServerResponse } from 'node:http'\nimport type { ParsedUrlQuery } from 'node:querystring'\nimport { RouteKind } from '../../route-kind'\nimport { BaseServerSpan } from '../../lib/trace/constants'\nimport { getTracer, SpanKind, type Span } from '../../lib/trace/tracer'\nimport { formatUrl } from '../../../shared/lib/router/utils/format-url'\nimport { addRequestMeta, getRequestMeta } from '../../request-meta'\nimport { interopDefault } from '../../app-render/interop-default'\nimport { getRevalidateReason } from '../../instrumentation/utils'\nimport { normalizeDataPath } from '../../../shared/lib/page-path/normalize-data-path'\nimport {\n  CachedRouteKind,\n  type CachedPageValue,\n  type CachedRedirectValue,\n  type ResponseCacheEntry,\n  type ResponseGenerator,\n} from '../../response-cache'\n\nimport {\n  getCacheControlHeader,\n  type CacheControl,\n} from '../../lib/cache-control'\nimport { normalizeRepeatedSlashes } from '../../../shared/lib/utils'\nimport { getRedirectStatus } from '../../../lib/redirect-status'\nimport {\n  CACHE_ONE_YEAR,\n  HTML_CONTENT_TYPE_HEADER,\n  JSON_CONTENT_TYPE_HEADER,\n} from '../../../lib/constants'\nimport path from 'path'\nimport { sendRenderResult } from '../../send-payload'\nimport RenderResult from '../../render-result'\nimport { toResponseCacheEntry } from '../../response-cache/utils'\nimport { NoFallbackError } from '../../../shared/lib/no-fallback-error.external'\nimport { RedirectStatusCode } from '../../../client/components/redirect-status-code'\nimport { isBot } from '../../../shared/lib/router/utils/is-bot'\nimport { addPathPrefix } from '../../../shared/lib/router/utils/add-path-prefix'\nimport { removeTrailingSlash } from '../../../shared/lib/router/utils/remove-trailing-slash'\nimport type { PagesRouteModule } from './module.compiled'\nimport type {\n  GetServerSideProps,\n  GetStaticPaths,\n  GetStaticProps,\n} from '../../../types'\n\nexport const getHandler = ({\n  srcPage: originalSrcPage,\n  config,\n  userland,\n  routeModule,\n  isFallbackError,\n  getStaticPaths,\n  getStaticProps,\n  getServerSideProps,\n}: {\n  srcPage: string\n  config: Record<string, any> | undefined\n  userland: any\n  isFallbackError?: boolean\n  routeModule: PagesRouteModule\n  getStaticProps?: GetStaticProps\n  getStaticPaths?: GetStaticPaths\n  getServerSideProps?: GetServerSideProps\n}) => {\n  return async function handler(\n    req: IncomingMessage,\n    res: ServerResponse,\n    ctx: {\n      waitUntil: (prom: Promise<void>) => void\n    }\n  ): Promise<void> {\n    let srcPage = originalSrcPage\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n      srcPage = srcPage.replace(/\\/index$/, '') || '/'\n    } else if (srcPage === '/index') {\n      // we always normalize /index specifically\n      srcPage = '/'\n    }\n    const multiZoneDraftMode = process.env\n      .__NEXT_MULTI_ZONE_DRAFT_MODE as any as boolean\n\n    const prepareResult = await routeModule.prepare(req, res, {\n      srcPage,\n      multiZoneDraftMode,\n    })\n\n    if (!prepareResult) {\n      res.statusCode = 400\n      res.end('Bad Request')\n      ctx.waitUntil?.(Promise.resolve())\n      return\n    }\n\n    const {\n      buildId,\n      query,\n      params,\n      parsedUrl,\n      originalQuery,\n      originalPathname,\n      buildManifest,\n      fallbackBuildManifest,\n      nextFontManifest,\n      serverFilesManifest,\n      reactLoadableManifest,\n      prerenderManifest,\n      isDraftMode,\n      isOnDemandRevalidate,\n      revalidateOnlyGenerated,\n      locale,\n      locales,\n      defaultLocale,\n      routerServerContext,\n      nextConfig,\n      resolvedPathname,\n      encodedResolvedPathname,\n    } = prepareResult\n\n    const isExperimentalCompile =\n      serverFilesManifest?.config?.experimental?.isExperimentalCompile\n\n    const hasServerProps = Boolean(getServerSideProps)\n    const hasStaticProps = Boolean(getStaticProps)\n    const hasStaticPaths = Boolean(getStaticPaths)\n    const hasGetInitialProps = Boolean(\n      (userland.default || userland).getInitialProps\n    )\n    let cacheKey: null | string = null\n    let isIsrFallback = false\n    let isNextDataRequest =\n      prepareResult.isNextDataRequest && (hasStaticProps || hasServerProps)\n\n    const is404Page = srcPage === '/404'\n    const is500Page = srcPage === '/500'\n    const isErrorPage = srcPage === '/_error'\n\n    if (!routeModule.isDev && !isDraftMode && hasStaticProps) {\n      cacheKey = `${locale ? `/${locale}` : ''}${\n        (srcPage === '/' || resolvedPathname === '/') && locale\n          ? ''\n          : resolvedPathname\n      }`\n\n      if (is404Page || is500Page || isErrorPage) {\n        cacheKey = `${locale ? `/${locale}` : ''}${srcPage}`\n      }\n\n      // ensure /index and / is normalized to one key\n      cacheKey = cacheKey === '/index' ? '/' : cacheKey\n    }\n\n    if (hasStaticPaths && !isDraftMode) {\n      const decodedPathname = removeTrailingSlash(\n        locale\n          ? addPathPrefix(resolvedPathname, `/${locale}`)\n          : resolvedPathname\n      )\n      const isPrerendered =\n        Boolean(prerenderManifest.routes[decodedPathname]) ||\n        prerenderManifest.notFoundRoutes.includes(decodedPathname)\n\n      const prerenderInfo = prerenderManifest.dynamicRoutes[srcPage]\n\n      if (prerenderInfo) {\n        if (prerenderInfo.fallback === false && !isPrerendered) {\n          throw new NoFallbackError()\n        }\n\n        if (\n          typeof prerenderInfo.fallback === 'string' &&\n          !isPrerendered &&\n          !isNextDataRequest\n        ) {\n          isIsrFallback = true\n        }\n      }\n    }\n\n    // When serving a bot request, we want to serve a blocking render and not\n    // the prerendered page. This ensures that the correct content is served\n    // to the bot in the head.\n    if (\n      (isIsrFallback && isBot(req.headers['user-agent'] || '')) ||\n      getRequestMeta(req, 'minimalMode')\n    ) {\n      isIsrFallback = false\n    }\n\n    const tracer = getTracer()\n    const activeSpan = tracer.getActiveScopeSpan()\n\n    try {\n      const method = req.method || 'GET'\n\n      const resolvedUrl = formatUrl({\n        pathname: nextConfig.trailingSlash\n          ? `${encodedResolvedPathname}${!encodedResolvedPathname.endsWith('/') && parsedUrl.pathname?.endsWith('/') ? '/' : ''}`\n          : removeTrailingSlash(encodedResolvedPathname || '/'),\n        // make sure to only add query values from original URL\n        query: hasStaticProps ? {} : originalQuery,\n      })\n\n      const handleResponse = async (span?: Span) => {\n        const responseGenerator: ResponseGenerator = async ({\n          previousCacheEntry,\n        }) => {\n          const doRender = async () => {\n            try {\n              return await routeModule\n                .render(req, res, {\n                  query:\n                    hasStaticProps && !isExperimentalCompile\n                      ? ({\n                          ...params,\n                        } as ParsedUrlQuery)\n                      : {\n                          ...query,\n                          ...params,\n                        },\n                  params,\n                  page: srcPage,\n                  renderContext: {\n                    isDraftMode,\n                    isFallback: isIsrFallback,\n                    developmentNotFoundSourcePage: getRequestMeta(\n                      req,\n                      'developmentNotFoundSourcePage'\n                    ),\n                  },\n                  sharedContext: {\n                    buildId,\n                    customServer:\n                      Boolean(routerServerContext?.isCustomServer) || undefined,\n                    deploymentId: process.env.NEXT_DEPLOYMENT_ID,\n                  },\n                  renderOpts: {\n                    params,\n                    routeModule,\n                    page: srcPage,\n                    pageConfig: config || {},\n                    Component: interopDefault(userland),\n                    ComponentMod: userland,\n                    getStaticProps,\n                    getStaticPaths,\n                    getServerSideProps,\n                    supportsDynamicResponse: !hasStaticProps,\n                    buildManifest: isFallbackError\n                      ? fallbackBuildManifest\n                      : buildManifest,\n                    nextFontManifest,\n                    reactLoadableManifest,\n\n                    assetPrefix: nextConfig.assetPrefix,\n                    previewProps: prerenderManifest.preview,\n                    images: nextConfig.images as any,\n                    nextConfigOutput: nextConfig.output,\n                    optimizeCss: Boolean(nextConfig.experimental.optimizeCss),\n                    nextScriptWorkers: Boolean(\n                      nextConfig.experimental.nextScriptWorkers\n                    ),\n                    domainLocales: nextConfig.i18n?.domains,\n                    crossOrigin: nextConfig.crossOrigin,\n\n                    multiZoneDraftMode,\n                    basePath: nextConfig.basePath,\n                    disableOptimizedLoading:\n                      nextConfig.experimental.disableOptimizedLoading,\n                    largePageDataBytes:\n                      nextConfig.experimental.largePageDataBytes,\n\n                    isExperimentalCompile,\n\n                    experimental: {\n                      clientTraceMetadata:\n                        nextConfig.experimental.clientTraceMetadata ||\n                        ([] as any),\n                    },\n\n                    locale,\n                    locales,\n                    defaultLocale,\n                    setIsrStatus: routerServerContext?.setIsrStatus,\n\n                    isNextDataRequest:\n                      isNextDataRequest && (hasServerProps || hasStaticProps),\n\n                    resolvedUrl,\n                    // For getServerSideProps and getInitialProps we need to ensure we use the original URL\n                    // and not the resolved URL to prevent a hydration mismatch on\n                    // asPath\n                    resolvedAsPath:\n                      hasServerProps || hasGetInitialProps\n                        ? formatUrl({\n                            // we use the original URL pathname less the _next/data prefix if\n                            // present\n                            pathname: isNextDataRequest\n                              ? normalizeDataPath(originalPathname)\n                              : originalPathname,\n                            query: originalQuery,\n                          })\n                        : resolvedUrl,\n\n                    isOnDemandRevalidate,\n\n                    ErrorDebug: getRequestMeta(req, 'PagesErrorDebug'),\n                    err: getRequestMeta(req, 'invokeError'),\n                    dev: routeModule.isDev,\n\n                    // needed for experimental.optimizeCss feature\n                    distDir: path.join(\n                      /* turbopackIgnore: true */\n                      process.cwd(),\n                      routeModule.relativeProjectDir,\n                      routeModule.distDir\n                    ),\n                  },\n                })\n                .then((renderResult): ResponseCacheEntry => {\n                  const { metadata } = renderResult\n\n                  let cacheControl: CacheControl | undefined =\n                    metadata.cacheControl\n\n                  if ('isNotFound' in metadata && metadata.isNotFound) {\n                    return {\n                      value: null,\n                      cacheControl,\n                    } satisfies ResponseCacheEntry\n                  }\n\n                  // Handle `isRedirect`.\n                  if (metadata.isRedirect) {\n                    return {\n                      value: {\n                        kind: CachedRouteKind.REDIRECT,\n                        props: metadata.pageData ?? metadata.flightData,\n                      } satisfies CachedRedirectValue,\n                      cacheControl,\n                    } satisfies ResponseCacheEntry\n                  }\n\n                  return {\n                    value: {\n                      kind: CachedRouteKind.PAGES,\n                      html: renderResult,\n                      pageData: renderResult.metadata.pageData,\n                      headers: renderResult.metadata.headers,\n                      status: renderResult.metadata.statusCode,\n                    },\n                    cacheControl,\n                  }\n                })\n                .finally(() => {\n                  if (!span) return\n\n                  span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false,\n                  })\n\n                  const rootSpanAttributes = tracer.getRootSpanAttributes()\n                  // We were unable to get attributes, probably OTEL is not enabled\n                  if (!rootSpanAttributes) {\n                    return\n                  }\n\n                  if (\n                    rootSpanAttributes.get('next.span_type') !==\n                    BaseServerSpan.handleRequest\n                  ) {\n                    console.warn(\n                      `Unexpected root span type '${rootSpanAttributes.get(\n                        'next.span_type'\n                      )}'. Please report this Next.js issue https://github.com/vercel/next.js`\n                    )\n                    return\n                  }\n\n                  const route = rootSpanAttributes.get('next.route')\n                  if (route) {\n                    const name = `${method} ${route}`\n\n                    span.setAttributes({\n                      'next.route': route,\n                      'http.route': route,\n                      'next.span_name': name,\n                    })\n                    span.updateName(name)\n                  } else {\n                    span.updateName(`${method} ${srcPage}`)\n                  }\n                })\n            } catch (err: unknown) {\n              // if this is a background revalidate we need to report\n              // the request error here as it won't be bubbled\n              if (previousCacheEntry?.isStale) {\n                await routeModule.onRequestError(\n                  req,\n                  err,\n                  {\n                    routerKind: 'Pages Router',\n                    routePath: srcPage,\n                    routeType: 'render',\n                    revalidateReason: getRevalidateReason({\n                      isStaticGeneration: hasStaticProps,\n                      isOnDemandRevalidate,\n                    }),\n                  },\n                  routerServerContext\n                )\n              }\n              throw err\n            }\n          }\n\n          // if we've already generated this page we no longer\n          // serve the fallback\n          if (previousCacheEntry) {\n            isIsrFallback = false\n          }\n\n          if (isIsrFallback) {\n            const fallbackResponse = await routeModule\n              .getResponseCache(req)\n              .get(\n                routeModule.isDev\n                  ? null\n                  : locale\n                    ? `/${locale}${srcPage}`\n                    : srcPage,\n                async ({\n                  previousCacheEntry: previousFallbackCacheEntry = null,\n                }) => {\n                  if (!routeModule.isDev) {\n                    return toResponseCacheEntry(previousFallbackCacheEntry)\n                  }\n                  return doRender()\n                },\n                {\n                  routeKind: RouteKind.PAGES,\n                  isFallback: true,\n                  isRoutePPREnabled: false,\n                  isOnDemandRevalidate: false,\n                  incrementalCache: await routeModule.getIncrementalCache(\n                    req,\n                    nextConfig,\n                    prerenderManifest\n                  ),\n                  waitUntil: ctx.waitUntil,\n                }\n              )\n            if (fallbackResponse) {\n              // Remove the cache control from the response to prevent it from being\n              // used in the surrounding cache.\n              delete fallbackResponse.cacheControl\n              fallbackResponse.isMiss = true\n              return fallbackResponse\n            }\n          }\n\n          if (\n            !getRequestMeta(req, 'minimalMode') &&\n            isOnDemandRevalidate &&\n            revalidateOnlyGenerated &&\n            !previousCacheEntry\n          ) {\n            res.statusCode = 404\n            // on-demand revalidate always sets this header\n            res.setHeader('x-nextjs-cache', 'REVALIDATED')\n            res.end('This page could not be found')\n            return null\n          }\n\n          if (\n            isIsrFallback &&\n            previousCacheEntry?.value?.kind === CachedRouteKind.PAGES\n          ) {\n            return {\n              value: {\n                kind: CachedRouteKind.PAGES,\n                html: new RenderResult(\n                  Buffer.from(previousCacheEntry.value.html),\n                  {\n                    contentType: HTML_CONTENT_TYPE_HEADER,\n                    metadata: {\n                      statusCode: previousCacheEntry.value.status,\n                      headers: previousCacheEntry.value.headers,\n                    },\n                  }\n                ),\n                pageData: {},\n                status: previousCacheEntry.value.status,\n                headers: previousCacheEntry.value.headers,\n              } satisfies CachedPageValue,\n              cacheControl: { revalidate: 0, expire: undefined },\n            } satisfies ResponseCacheEntry\n          }\n          return doRender()\n        }\n\n        const result = await routeModule.handleResponse({\n          cacheKey,\n          req,\n          nextConfig,\n          routeKind: RouteKind.PAGES,\n          isOnDemandRevalidate,\n          revalidateOnlyGenerated,\n          waitUntil: ctx.waitUntil,\n          responseGenerator: responseGenerator,\n          prerenderManifest,\n        })\n\n        // if we got a cache hit this wasn't an ISR fallback\n        // but it wasn't generated during build so isn't in the\n        // prerender-manifest\n        if (isIsrFallback && !result?.isMiss) {\n          isIsrFallback = false\n        }\n\n        // response is finished is no cache entry\n        if (!result) {\n          return\n        }\n\n        if (hasStaticProps && !getRequestMeta(req, 'minimalMode')) {\n          res.setHeader(\n            'x-nextjs-cache',\n            isOnDemandRevalidate\n              ? 'REVALIDATED'\n              : result.isMiss\n                ? 'MISS'\n                : result.isStale\n                  ? 'STALE'\n                  : 'HIT'\n          )\n        }\n\n        let cacheControl: CacheControl | undefined\n\n        if (!hasStaticProps || isIsrFallback) {\n          if (!res.getHeader('Cache-Control')) {\n            cacheControl = { revalidate: 0, expire: undefined }\n          }\n        } else if (is404Page) {\n          const notFoundRevalidate = getRequestMeta(req, 'notFoundRevalidate')\n\n          cacheControl = {\n            revalidate:\n              typeof notFoundRevalidate === 'undefined'\n                ? 0\n                : notFoundRevalidate,\n            expire: undefined,\n          }\n        } else if (is500Page) {\n          cacheControl = { revalidate: 0, expire: undefined }\n        } else if (result.cacheControl) {\n          // If the cache entry has a cache control with a revalidate value that's\n          // a number, use it.\n          if (typeof result.cacheControl.revalidate === 'number') {\n            if (result.cacheControl.revalidate < 1) {\n              throw new Error(\n                `Invalid revalidate configuration provided: ${result.cacheControl.revalidate} < 1`\n              )\n            }\n            cacheControl = {\n              revalidate: result.cacheControl.revalidate,\n              expire: result.cacheControl?.expire ?? nextConfig.expireTime,\n            }\n          } else {\n            // revalidate: false\n            cacheControl = {\n              revalidate: CACHE_ONE_YEAR,\n              expire: undefined,\n            }\n          }\n        }\n\n        // If cache control is already set on the response we don't\n        // override it to allow users to customize it via next.config\n        if (cacheControl && !res.getHeader('Cache-Control')) {\n          res.setHeader('Cache-Control', getCacheControlHeader(cacheControl))\n        }\n\n        // notFound: true case\n        if (!result.value) {\n          // add revalidate metadata before rendering 404 page\n          // so that we can use this as source of truth for the\n          // cache-control header instead of what the 404 page returns\n          // for the revalidate value\n          addRequestMeta(\n            req,\n            'notFoundRevalidate',\n            result.cacheControl?.revalidate\n          )\n\n          res.statusCode = 404\n\n          if (isNextDataRequest) {\n            res.end('{\"notFound\":true}')\n            return\n          }\n          // TODO: should route-module itself handle rendering the 404\n          if (routerServerContext?.render404) {\n            await routerServerContext.render404(req, res, parsedUrl, false)\n          } else {\n            res.end('This page could not be found')\n          }\n          return\n        }\n\n        if (result.value.kind === CachedRouteKind.REDIRECT) {\n          if (isNextDataRequest) {\n            res.setHeader('content-type', JSON_CONTENT_TYPE_HEADER)\n            res.end(JSON.stringify(result.value.props))\n            return\n          } else {\n            const handleRedirect = (pageData: any) => {\n              const redirect = {\n                destination: pageData.pageProps.__N_REDIRECT,\n                statusCode: pageData.pageProps.__N_REDIRECT_STATUS,\n                basePath: pageData.pageProps.__N_REDIRECT_BASE_PATH,\n              }\n              const statusCode = getRedirectStatus(redirect)\n              const { basePath } = nextConfig\n\n              if (\n                basePath &&\n                redirect.basePath !== false &&\n                redirect.destination.startsWith('/')\n              ) {\n                redirect.destination = `${basePath}${redirect.destination}`\n              }\n\n              if (redirect.destination.startsWith('/')) {\n                redirect.destination = normalizeRepeatedSlashes(\n                  redirect.destination\n                )\n              }\n\n              res.statusCode = statusCode\n              res.setHeader('Location', redirect.destination)\n              if (statusCode === RedirectStatusCode.PermanentRedirect) {\n                res.setHeader('Refresh', `0;url=${redirect.destination}`)\n              }\n              res.end(redirect.destination)\n            }\n            await handleRedirect(result.value.props)\n            return null\n          }\n        }\n\n        if (result.value.kind !== CachedRouteKind.PAGES) {\n          throw new Error(\n            `Invariant: received non-pages cache entry in pages handler`\n          )\n        }\n\n        // In dev, we should not cache pages for any reason.\n        if (routeModule.isDev) {\n          res.setHeader('Cache-Control', 'no-store, must-revalidate')\n        }\n\n        // Draft mode should never be cached\n        if (isDraftMode) {\n          res.setHeader(\n            'Cache-Control',\n            'private, no-cache, no-store, max-age=0, must-revalidate'\n          )\n        }\n\n        // when invoking _error before pages/500 we don't actually\n        // send the _error response\n        if (\n          getRequestMeta(req, 'customErrorRender') ||\n          (isErrorPage &&\n            getRequestMeta(req, 'minimalMode') &&\n            res.statusCode === 500)\n        ) {\n          return null\n        }\n\n        await sendRenderResult({\n          req,\n          res,\n          // If we are rendering the error page it's not a data request\n          // anymore\n          result:\n            isNextDataRequest && !isErrorPage && !is500Page\n              ? new RenderResult(\n                  Buffer.from(JSON.stringify(result.value.pageData)),\n                  {\n                    contentType: JSON_CONTENT_TYPE_HEADER,\n                    metadata: result.value.html.metadata,\n                  }\n                )\n              : result.value.html,\n          generateEtags: nextConfig.generateEtags,\n          poweredByHeader: nextConfig.poweredByHeader,\n          cacheControl: routeModule.isDev ? undefined : cacheControl,\n        })\n      }\n\n      // TODO: activeSpan code path is for when wrapped by\n      // next-server can be removed when this is no longer used\n      if (activeSpan) {\n        await handleResponse()\n      } else {\n        await tracer.withPropagatedContext(req.headers, () =>\n          tracer.trace(\n            BaseServerSpan.handleRequest,\n            {\n              spanName: `${method} ${srcPage}`,\n              kind: SpanKind.SERVER,\n              attributes: {\n                'http.method': method,\n                'http.target': req.url,\n              },\n            },\n            handleResponse\n          )\n        )\n      }\n    } catch (err) {\n      if (!(err instanceof NoFallbackError)) {\n        await routeModule.onRequestError(\n          req,\n          err,\n          {\n            routerKind: 'Pages Router',\n            routePath: srcPage,\n            routeType: 'render',\n            revalidateReason: getRevalidateReason({\n              isStaticGeneration: hasStaticProps,\n              isOnDemandRevalidate,\n            }),\n          },\n          routerServerContext\n        )\n      }\n\n      // rethrow so that we can handle serving error page\n      throw err\n    }\n  }\n}\n"],"names":["RouteKind","BaseServerSpan","getTracer","SpanKind","formatUrl","addRequestMeta","getRequestMeta","interopDefault","getRevalidateReason","normalizeDataPath","CachedRouteKind","getCacheControlHeader","normalizeRepeatedSlashes","getRedirectStatus","CACHE_ONE_YEAR","HTML_CONTENT_TYPE_HEADER","JSON_CONTENT_TYPE_HEADER","path","sendRenderResult","RenderResult","toResponseCacheEntry","NoFallbackError","RedirectStatusCode","isBot","addPathPrefix","removeTrailingSlash","getHandler","srcPage","originalSrcPage","config","userland","routeModule","isFallbackError","getStaticPaths","getStaticProps","getServerSideProps","handler","req","res","ctx","serverFilesManifest","process","env","TURBOPACK","replace","multiZoneDraftMode","__NEXT_MULTI_ZONE_DRAFT_MODE","prepareResult","prepare","statusCode","end","waitUntil","Promise","resolve","buildId","query","params","parsedUrl","originalQuery","originalPathname","buildManifest","fallbackBuildManifest","nextFontManifest","reactLoadableManifest","prerenderManifest","isDraftMode","isOnDemandRevalidate","revalidateOnlyGenerated","locale","locales","defaultLocale","routerServerContext","nextConfig","resolvedPathname","encodedResolvedPathname","isExperimentalCompile","experimental","hasServerProps","Boolean","hasStaticProps","hasStaticPaths","hasGetInitialProps","default","getInitialProps","cacheKey","isIsrFallback","isNextDataRequest","is404Page","is500Page","isErrorPage","isDev","decodedPathname","isPrerendered","routes","notFoundRoutes","includes","prerenderInfo","dynamicRoutes","fallback","headers","tracer","activeSpan","getActiveScopeSpan","method","resolvedUrl","pathname","trailingSlash","endsWith","handleResponse","span","responseGenerator","previousCacheEntry","doRender","render","page","renderContext","isFallback","developmentNotFoundSourcePage","sharedContext","customServer","isCustomServer","undefined","deploymentId","NEXT_DEPLOYMENT_ID","renderOpts","pageConfig","Component","ComponentMod","supportsDynamicResponse","assetPrefix","previewProps","preview","images","nextConfigOutput","output","optimizeCss","nextScriptWorkers","domainLocales","i18n","domains","crossOrigin","basePath","disableOptimizedLoading","largePageDataBytes","clientTraceMetadata","setIsrStatus","resolvedAsPath","ErrorDebug","err","dev","distDir","join","cwd","relativeProjectDir","then","renderResult","metadata","cacheControl","isNotFound","value","isRedirect","kind","REDIRECT","props","pageData","flightData","PAGES","html","status","finally","setAttributes","rootSpanAttributes","getRootSpanAttributes","get","handleRequest","console","warn","route","name","updateName","isStale","onRequestError","routerKind","routePath","routeType","revalidateReason","isStaticGeneration","fallbackResponse","getResponseCache","previousFallbackCacheEntry","routeKind","isRoutePPREnabled","incrementalCache","getIncrementalCache","isMiss","setHeader","Buffer","from","contentType","revalidate","expire","result","getHeader","notFoundRevalidate","Error","expireTime","render404","JSON","stringify","handleRedirect","redirect","destination","pageProps","__N_REDIRECT","__N_REDIRECT_STATUS","__N_REDIRECT_BASE_PATH","startsWith","PermanentRedirect","generateEtags","poweredByHeader","withPropagatedContext","trace","spanName","SERVER","attributes","url"],"mappings":"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","ignoreList":[0]}